# book-list
## 概要
CDKとReact(共にTypeScript)による読書記録アプリです。

Lambda+API Gatewayによって構成されたRESTful API、S3とCloudFront上に配置されたReactアプリ、そして認証機能のためのCognitoによって構成されています。

また、書籍情報の取得は、楽天ブックス総合検索APIを用いて行っています。

## セットアップ手順
### コマンドインストール
下記コマンドが実行できるようにしてください。

コマンド|実行ディレクトリ|(参考)リポジトリ作成者の実行バージョン|備考
-|-|-|-|
npm|book-list-backend/|9.4.0|
cdk|book-list-backend/|2.62.2|AdministratorAccessポリシーが付与されたIAMユーザーで<br/>実行できるように設定してください
yarn|book-list-frontend/|1.22.19|

なお、上記コマンドの内、`npm`と`cdk`がデフォルトで使え、またアクセスキーの作成が不要でセキュリティー上のリスクを減らせる、Cloud9のご使用をおすすめします。Cloud9をご使用になる際、EC2のインスタンスタイプは
t2.small以上のスペックのものを推奨します。

### ライブラリインストールとフロントエンドアプリの仮ビルド
下記コマンドを実行し、ライブラリをインストールし、フロントエンドアプリの仮ビルドを行います。

``` bash
$ cd book-list-backend/
$ npm install
$ cd ../book-list-frontend/
$ yarn install
$ yarn build
$ cd ../
```

フロントエンドアプリは、この時点では画面を表示するには、準備が完了していないので、あくまでも仮ビルドになります。

### 楽天ウェブサービスでアプリIDを取得
楽天ウェブサービスでアプリを登録します。アプリを登録すると、アプリIDが取得できます。
 
その後`book-list-backend/infrastructure/Config.ts`に記載された`config.RAKUTEN_API_APP_ID`の値をアプリIDに変更してください。
 
なお、楽天ウェブサービスでアプリを登録し、アプリIDを取得する方法は[ご利用ガイド](https://webservice.rakuten.co.jp/guide)をご参照ください。

### バックエンドのデプロイ
下記コマンドを実行し、CDKを用いてバックエンドをデプロイします。

``` bash
$ cd book-list-backend/
$ cdk deploy #この時に出力される「Outputs」を記録しておきます
$ cd ../
```

### フロントエンドのデプロイ
上記`cdk deploy`を実行した際に出力された、`Outputs`をもとに、`book-list-frontend/.env`の値を変更します。

キー|値
-|-
REACT_APP_API_ROOT_URL|`BookList.BookListWebAppCloudFrontUrl`の値
REACT_APP_AWS_USER_POOLS_ID|`BookList.UserPoolId`の値
REACT_APP_AWS_USER_POOLS_CLIENT_ID|`BookList.UserPoolClientId`の値

その後、以下コマンドを実行し、フロントエンドのデプロイします。

``` bash
$ cd book-list-frontend/
$ yarn build
$ cd ../book-list-backend/
$ cdk deploy
```

その後、`cdk deploy`を実行した際に出力された、`Outputs`にある`BookList.BookListWebAppCloudFrontUrl`に記載されたURLをブラウザで表示すると、画面が表示されます。

もしも何も表示されない場合には、ブラウザおよびCloudFrontのキャッシュの削除をおすすめします。
CloudFrontのキャッシュの削除の方法は下記をご参照ください。

https://aws.amazon.com/jp/premiumsupport/knowledge-center/cloudfront-clear-cache/

## 画面の操作方法

### サインインまたはアカウント登録
画面上に、サインインフォームが表示されています。すでにユーザーを登録済みの場合には、ユーザーネームとパスワードを入力後、「Sign in」ボタンを押下し、サインインを行ってください。

アカウントを登録する際には、フォーム右上の「Create Account」タブを押下し、アカウント登録フォームを表示します。
ユーザーネーム、パスワード、メールアドレスを入力し、「Create Account」ボタンを押下してください。認証コードが記載されたメールアドレスが届き、画面上でも認証コードを入力するように
フォームが切り替わりますので、認証コードを入力、「Confirm」ボタンを押下します。

### 書籍を探す
サインイン後は、すでに読んだことのある書籍や、将来読みたい書籍を探します。

「本を探す」リンクを押下し、検索ページを開きます。
著者名やISBNなどを検索フォームに入力した後、虫眼鏡のアイコンを押下します。

その後、検索で見つかった各書籍の、画像、著者名、出版元名、「読了リストに追加」ボタン、「読みたいリストに追加」ボタンがそれぞれ表示されます。
「読了リストに追加」ボタン、または「読みたいリストに追加」ボタンを押下することで、読んだことのある書籍をまとめた読了リスト、将来読みたい書籍をまとめた「読みたいリスト」に追加することができます。


### 書籍の一覧を確認する
ホーム画面では、「読了リスト」と「読みたいリスト」のタブが横並びで表示されており、それぞれのタブを押下することで、リストに登録されている書籍を一覧で確認することができます。

それぞれのリストには「詳細を見る」ボタンと「削除」ボタンがあり、書籍の詳細ページに遷移したり、リストから書籍を削除するための削除ができます。
「読みたいリスト」の各書籍には「読了リストに移動」ボタンも表示されており、このボタンを押下することで、「読了リスト」に移動させることもできます。

### 書籍の詳細を確認する
書籍の一覧に表示された各書籍の「詳細を見る」ボタンを押下することで、書籍の詳細ページが確認できます。
書籍の詳細ページでは、タイトル、楽天で書籍のページを開くための「楽天で見る」ボタン、画像、著者名、出版元、出版日、ISBN、説明文が表示される他、
リストから書籍を削除するための「削除」ボタンが表示されます。
また、読了リストの書籍であればメモを入力するためのフォームと「更新」ボタン、読みたいリストの書籍であれば「読了リストに移動」ボタンが表示され、また各リストの書籍一覧ページに戻るための
リンクが表示されます。
